{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { QueryClient } from '@tanstack/react-query';\nimport { API_BASE_URL } from \"../config/api\";\nexport var queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      retry: 1,\n      refetchOnWindowFocus: false,\n      staleTime: 5 * 60 * 1000\n    }\n  }\n});\nexport function buildApiUrl(endpoint) {\n  if (endpoint.startsWith('http')) {\n    return endpoint;\n  }\n  var normalizedEndpoint = endpoint.startsWith('/') ? endpoint : `/${endpoint}`;\n  return `${API_BASE_URL}${normalizedEndpoint}`;\n}\nexport function getQueryFn() {\n  var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  return function () {\n    var _ref2 = _asyncToGenerator(function* (_ref) {\n      var queryKey = _ref.queryKey;\n      var endpoint = String(queryKey[0]);\n      var url = buildApiUrl(endpoint);\n      console.log(`Making API request to: ${url}`);\n      try {\n        var res = yield fetch(url, {\n          credentials: 'include'\n        });\n        if (!res.ok) {\n          if (res.status === 401 && options.on401 === 'returnNull') {\n            return null;\n          }\n          if (res.status === 404 && options.on404 === 'returnNull') {\n            return null;\n          }\n          var errorText = yield res.text();\n          throw new Error(errorText || `API error ${res.status}`);\n        }\n        var contentType = res.headers.get('content-type');\n        if (contentType && contentType.includes('application/json')) {\n          return res.json();\n        }\n        return null;\n      } catch (error) {\n        console.error(`API Request to ${url} failed:`, error);\n        throw error;\n      }\n    });\n    return function (_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n}\nexport function apiRequest(_x2, _x3, _x4) {\n  return _apiRequest.apply(this, arguments);\n}\nfunction _apiRequest() {\n  _apiRequest = _asyncToGenerator(function* (method, endpoint, data) {\n    var url = buildApiUrl(endpoint);\n    console.log(`Making ${method} request to: ${url}`);\n    var options = {\n      method: method,\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      credentials: 'include'\n    };\n    if (data) {\n      options.body = JSON.stringify(data);\n    }\n    try {\n      var response = yield fetch(url, options);\n      return response;\n    } catch (error) {\n      console.error(`${method} request to ${url} failed:`, error);\n      throw error;\n    }\n  });\n  return _apiRequest.apply(this, arguments);\n}","map":{"version":3,"names":["QueryClient","API_BASE_URL","queryClient","defaultOptions","queries","retry","refetchOnWindowFocus","staleTime","buildApiUrl","endpoint","startsWith","normalizedEndpoint","getQueryFn","options","arguments","length","undefined","_ref2","_asyncToGenerator","_ref","queryKey","String","url","console","log","res","fetch","credentials","ok","status","on401","on404","errorText","text","Error","contentType","headers","get","includes","json","error","_x","apply","apiRequest","_x2","_x3","_x4","_apiRequest","method","data","body","JSON","stringify","response"],"sources":["/home/runner/workspace/mobile/src/api/queryClient.ts"],"sourcesContent":["import { QueryClient } from '@tanstack/react-query';\nimport { API_BASE_URL } from '../config/api';\n\n// Initialize QueryClient\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      retry: 1,\n      refetchOnWindowFocus: false,\n      staleTime: 5 * 60 * 1000, // 5 minutes\n    },\n  },\n});\n\n// Interface for QueryFn options\ninterface GetQueryFnOptions {\n  on401?: 'throw' | 'returnNull';\n  on404?: 'throw' | 'returnNull';\n}\n\n// Utility to build full URLs from endpoints\nexport function buildApiUrl(endpoint: string): string {\n  // If the endpoint already starts with http, assume it's a full URL\n  if (endpoint.startsWith('http')) {\n    return endpoint;\n  }\n  \n  // Make sure endpoint starts with a slash\n  const normalizedEndpoint = endpoint.startsWith('/') ? endpoint : `/${endpoint}`;\n  return `${API_BASE_URL}${normalizedEndpoint}`;\n}\n\n// Default fetcher with error handling options\nexport function getQueryFn(options: GetQueryFnOptions = {}) {\n  return async ({ queryKey }: { queryKey: readonly unknown[] }): Promise<any> => {\n    const endpoint = String(queryKey[0]);\n    const url = buildApiUrl(endpoint);\n    \n    console.log(`Making API request to: ${url}`);\n    \n    try {\n      const res = await fetch(url, { credentials: 'include' });\n\n      if (!res.ok) {\n        if (res.status === 401 && options.on401 === 'returnNull') {\n          return null;\n        }\n        if (res.status === 404 && options.on404 === 'returnNull') {\n          return null;\n        }\n        \n        const errorText = await res.text();\n        throw new Error(errorText || `API error ${res.status}`);\n      }\n\n      // For non-JSON responses like empty responses\n      const contentType = res.headers.get('content-type');\n      if (contentType && contentType.includes('application/json')) {\n        return res.json();\n      }\n\n      return null;\n    } catch (error) {\n      console.error(`API Request to ${url} failed:`, error);\n      throw error;\n    }\n  };\n}\n\n// Function for making API requests\nexport async function apiRequest(\n  method: 'GET' | 'POST' | 'PATCH' | 'DELETE', \n  endpoint: string, \n  data?: any\n): Promise<Response> {\n  const url = buildApiUrl(endpoint);\n  \n  console.log(`Making ${method} request to: ${url}`);\n  \n  const options: RequestInit = {\n    method,\n    headers: {\n      'Content-Type': 'application/json',\n    },\n    credentials: 'include',\n  };\n\n  if (data) {\n    options.body = JSON.stringify(data);\n  }\n\n  try {\n    const response = await fetch(url, options);\n    return response;\n  } catch (error) {\n    console.error(`${method} request to ${url} failed:`, error);\n    throw error;\n  }\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}